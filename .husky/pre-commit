# Run lint-staged on staged files (linting, formatting, security checks)
pnpm exec lint-staged

# Security: Check for dependency vulnerabilities (moderate and above)
echo "üîí Checking for security vulnerabilities..."
pnpm audit --audit-level=moderate --json > /dev/null 2>&1 || {
  echo "‚ö†Ô∏è  Security vulnerabilities detected. Run 'pnpm audit' for details."
  echo "   Consider running 'pnpm audit fix' to resolve automatically fixable issues."
  # Uncomment to block commits on security vulnerabilities:
  # exit 1
}

# Run type checking on all packages (quick check)
# Currently warns but doesn't block - uncomment exit 1 to block on type errors
pnpm type-check || {
  echo "‚ö†Ô∏è  Type check failed. Consider fixing type errors before committing."
  # exit 1  # Uncomment to block commits on type errors
}

# Run unit tests (only on changed packages for speed)
# This runs tests but doesn't fail the commit if tests fail
# Uncomment the exit 1 line if you want to block commits on test failures
pnpm test:unit || {
  echo "‚ö†Ô∏è  Some tests failed. Consider fixing them before committing."
  # exit 1  # Uncomment to block commits on test failures
}
